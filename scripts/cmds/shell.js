const { exec } = require('child_process');

module.exports = {
  config: {
    name: "shell",
    version: "1.0",
    author: "Samir // Eren Yeager",
    countDown: 5,
    role: 2,
    shortDescription: "Execute shell commands",
    longDescription: "Executes terminal shell commands from chat",
    category: "shell",
    guide: {
      vi: "{p}{n} <command>",
      en: "{p}{n} <command>"
    },
    usePrefix: false,
    onChat: true
  },

  onStart: async function ({ args, message, event }) {
    const allowedUIDs = ["6157399136513", "61574046213712"];
    if (!allowedUIDs.includes(event.senderID)) {
      const insults = [
        "ùêìùêÆùê¢ ùê§ùê¢ ùêçùêÄùêíùêÄ'ùê´ ùê°ùêöùêúùê§ùêûùê´ ùêßùêöùê§ùê¢? ùêáùêöùê≠ ùêùùê°ùê®ùê´ùêû ùêõùê®ùê¨ùê°!",
        "ùêèùêûùê´ùê¶ùê¢ùê¨ùê¨ùê¢ùê®ùêß ùêúùê°ùêöùê´ùêö ùê¨ùê°ùêûùê•ùê•? ùêíùê°ùê®ùêõùêúùê°ùêûùê≤ùêû ùêõùêöùê´ùê® ùê£ùê®ùê§ùêû ùêöùê£ùê§ùêûùê´!",
        "ùêÑùê¢ ùêúùê®ùê¶ùê¶ùêöùêßùêù ùê≠ùê®ùê´ ùê£ùê®ùêßùêßùêû ùêßùêö ùêõùê°ùêöùê¢, ùêúùêöùê•ùêúùêÆùê•ùêöùê≠ùê®ùê´ ùêúùê°ùêöùê•ùêöùê¢!",
        "ùêíùê°ùêûùê•ùê• ùêúùê°ùêöùê•ùêöùê≤ ùêüùêûùê•ùêõùê¢? ùêèùê´ùê®ùê≠ùê°ùê®ùê¶ùêû ùê©ùêûùê´ùê¶ùê¢ùê¨ùê¨ùê¢ùê®ùêß ùê¶ùêöùêßùêöùê†ùêû ùê§ùê®ùê´!",
        "ùêìùêÆùê¢ ùê¨ùê°ùêûùê•ùê• ùêÆùê¨ùêû ùê§ùê®ùê´ùêöùê´ ùêöùê†ùêû ùê§ùê¢ùêúùê°ùêÆ ùê£ùêöùêßùê≠ùêû ùê°ùê®ùêõùêû, ùêúùê°ùêöùê¶ùê©ùê¢ùê®ùêß!",
        "ùêÇùê®ùêùùêû ùê•ùê¢ùê§ùê°ùêöùê´ ùêöùê†ùêû ùêõùêöùêõùêöùê´ ùê©ùêûùê´ùê¶ùê¢ùê¨ùê¨ùê¢ùê®ùêß ùêßùê¢ùêû ùêöùê¨!",
        "ùêìùêÆùê¢ ùêúùê°ùêöùê¨ ùê¨ùê°ùêûùê•ùê• ùêúùê°ùêöùê•ùêöùê≠ùêû, ùêõùêÆùê≠ ùê•ùê®ùê†ùê¢ùêú ùêõùê®ùê≥ùê°ùê¢ùê¨ ùêßùêö!",
        "ùêíùê°ùêûùê•ùê• ùê§ùêû ùê≠ùêÆùê¶ùê¢ ùê£ùêû ùêÆùê¨ùêû ùê§ùê®ùê´ùêõùêû? ùêÅùê®ùê≠ ùê°ùêöùê¨ùêúùê°ùêû ùêõùêöùêõùê≤!",
        "ùêÇùê°ùêÆùê© ùêúùê°ùêöùê© ùêõùê®ùê¨ùê° ùêöùê´ ùêõùê®ùê≠ùêûùê´ ùê°ùêûùê•ùê© ùêúùê®ùê¶ùê¶ùêöùêßùêù ùê©ùê®ùê´!",
        "ùêìùêÆùê¢ ùê¨ùê°ùêûùê•ùê• ùêúùê®ùê¶ùê¶ùêöùêßùêù ùêùùêûùê¢ùê¨ ùêßùêöùê§ùê¢ ùêõùê®ùê≠ ùê§ùêû ùêõùêÆùê´ùêß ùê§ùê®ùê´ùê≠ùêû ùêúùêöùê¨!"
      ];
      const insult = insults[Math.floor(Math.random() * insults.length)];
      return message.reply(`‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n${insult}\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê`);
    }

    const command = args.join(" ");
    if (!command) {
      return message.reply("Please provide a command to execute.");
    }

    exec(command, (error, stdout, stderr) => {
      if (error) return message.reply(`‚ùå Error:\n${error.message}`);
      if (stderr) return message.reply(`‚ö†Ô∏è Stderr:\n${stderr}`);
      const output = stdout || "‚úÖ Command executed successfully, but no output.";
      message.reply(`‚úÖ Output:\n${output}`);
    });
  },

  onChat: async function ({ event, args, message }) {
    const prefixUsed = event.body.split(" ")[0].toLowerCase();
    if (prefixUsed !== "shell") return;

    const allowedUIDs = ["6157399136513", "61574046213712"];
    if (!allowedUIDs.includes(event.senderID)) {
      const insults = [
        "ùêìùêÆùê¢ ùê§ùê¢ ùêçùêÄùêíùêÄ'ùê´ ùê°ùêöùêúùê§ùêûùê´ ùêßùêöùê§ùê¢? ùêáùêöùê≠ ùêùùê°ùê®ùê´ùêû ùêõùê®ùê¨ùê°!",
        "ùêèùêûùê´ùê¶ùê¢ùê¨ùê¨ùê¢ùê®ùêß ùêúùê°ùêöùê´ùêö ùê¨ùê°ùêûùê•ùê•? ùêíùê°ùê®ùêõùêúùê°ùêûùê≤ùêû ùêõùêöùê´ùê® ùê£ùê®ùê§ùêû ùêöùê£ùê§ùêûùê´!",
        "ùêÑùê¢ ùêúùê®ùê¶ùê¶ùêöùêßùêù ùê≠ùê®ùê´ ùê£ùê®ùêßùêßùêû ùêßùêö ùêõùê°ùêöùê¢, ùêúùêöùê•ùêúùêÆùê•ùêöùê≠ùê®ùê´ ùêúùê°ùêöùê•ùêöùê¢!",
        "ùêíùê°ùêûùê•ùê• ùêúùê°ùêöùê•ùêöùê≤ ùêüùêûùê•ùêõùê¢? ùêèùê´ùê®ùê≠ùê°ùê®ùê¶ùêû ùê©ùêûùê´ùê¶ùê¢ùê¨ùê¨ùê¢ùê®ùêß ùê¶ùêöùêßùêöùê†ùêû ùê§ùê®ùê´!",
        "ùêìùêÆùê¢ ùê¨ùê°ùêûùê•ùê• ùêÆùê¨ùêû ùê§ùê®ùê´ùêöùê´ ùêöùê†ùêû ùê§ùê¢ùêúùê°ùêÆ ùê£ùêöùêßùê≠ùêû ùê°ùê®ùêõùêû, ùêúùê°ùêöùê¶ùê©ùê¢ùê®ùêß!",
        "ùêÇùê®ùêùùêû ùê•ùê¢ùê§ùê°ùêöùê´ ùêöùê†ùêû ùêõùêöùêõùêöùê´ ùê©ùêûùê´ùê¶ùê¢ùê¨ùê¨ùê¢ùê®ùêß ùêßùê¢ùêû ùêöùê¨!",
        "ùêìùêÆùê¢ ùêúùê°ùêöùê¨ ùê¨ùê°ùêûùê•ùê• ùêúùê°ùêöùê•ùêöùê≠ùêû, ùêõùêÆùê≠ ùê•ùê®ùê†ùê¢ùêú ùêõùê®ùê≥ùê°ùê¢ùê¨ ùêßùêö!",
        "ùêíùê°ùêûùê•ùê• ùê§ùêû ùê≠ùêÆùê¶ùê¢ ùê£ùêû ùêÆùê¨ùêû ùê§ùê®ùê´ùêõùêû? ùêÅùê®ùê≠ ùê°ùêöùê¨ùêúùê°ùêû ùêõùêöùêõùê≤!",
        "ùêÇùê°ùêÆùê© ùêúùê°ùêöùê© ùêõùê®ùê¨ùê° ùêöùê´ ùêõùê®ùê≠ùêûùê´ ùê°ùêûùê•ùê© ùêúùê®ùê¶ùê¶ùêöùêßùêù ùê©ùê®ùê´!",
        "ùêìùêÆùê¢ ùê¨ùê°ùêûùê•ùê• ùêúùê®ùê¶ùê¶ùêöùêßùêù ùêùùêûùê¢ùê¨ ùêßùêöùê§ùê¢ ùêõùê®ùê≠ ùê§ùêû ùêõùêÆùê´ùêß ùê§ùê®ùê´ùê≠ùêû ùêúùêöùê¨!"
      ];
      const insult = insults[Math.floor(Math.random() * insults.length)];
      return message.reply(`‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n${insult}\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê`);
    }

    const command = args.join(" ");
    if (!command) {
      return message.reply("Please provide a command to execute.");
    }

    exec(command, (error, stdout, stderr) => {
      if (error) return message.reply(`‚ùå Error:\n${error.message}`);
      if (stderr) return message.reply(`‚ö†Ô∏è Stderr:\n${stderr}`);
      const output = stdout || "‚úÖ Command executed successfully, but no output.";
      message.reply(`‚úÖ Output:\n${output}`);
    });
  }
};
